name: centaurx

services:
  centaurx:
    image: docker.io/pktsystems/centaurx:v0.5.1
    container_name: centaurx
    read_only: true
    environment:
      - HOME=/centaurx
      - CENTAURX_HOST_STATE_DIR=${HOME}/.centaurx/state
      - CENTAURX_HOST_REPO_ROOT=${HOME}/.centaurx/repos
    tmpfs:
      - /tmp
      - /run
      - /var/run
      - /var/tmp
      - /centaurx
    ports:
      - "27480:27480"
      - "27422:27422"
    volumes:
      - ${HOME}/.centaurx/state:/cx/state
      - ${HOME}/.centaurx/repos:/cx/repos
      - ${HOME}/.centaurx/config-for-container.yaml:/cx/config-for-container.yaml:ro
      - /run/user/${UID}/podman/podman.sock:/cx/podman.sock:ro
    command: ["serve", "-c", "/cx/config-for-container.yaml"]
